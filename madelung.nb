(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      6281,        211]
NotebookOptionsPosition[      5991,        198]
NotebookOutlinePosition[      6327,        213]
CellTagsIndexPosition[      6284,        210]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"b1", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"basis", " ", "vectors"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1"}], "}"}], "*", 
    RowBox[{"a", "/", "2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0"}], "}"}], "*", 
    RowBox[{"a", "/", "2"}]}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"lattice", " ", "vectors"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"a2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1"}], "}"}], "*", 
    RowBox[{"a", "/", "2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"a3", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "1"}], "}"}], "*", 
    RowBox[{"a", "/", "2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ar1", "=", 
   RowBox[{"2", "*", 
    RowBox[{"Pi", "/", "a"}], "*", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}]}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"reciprocal", " ", "vectors"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ar2", "=", 
   RowBox[{"2", "*", 
    RowBox[{"Pi", "/", "a"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ar3", "=", 
   RowBox[{"2", "*", 
    RowBox[{"Pi", "/", "a"}], "*", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"4", "/", 
    RowBox[{"a", "^", "2"}]}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"splitting", " ", "parameter"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ar", "=", 
   RowBox[{
    RowBox[{"i", "*", "ar1"}], "+", 
    RowBox[{"j", "*", "ar2"}], "+", 
    RowBox[{"k", "*", "ar3"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"i", "*", "a1"}], "+", 
    RowBox[{"j", "*", "a2"}], "+", 
    RowBox[{"k", "*", "a3"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"arn", "=", 
   RowBox[{"Norm", "[", "ar", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"an", "=", 
   RowBox[{"Norm", "[", "aa", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"n", "=", "5"}], ";", 
  RowBox[{"(*", 
   RowBox[{"number", " ", "of", " ", "sums"}], "*)"}], 
  RowBox[{"s1", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "\[NotEqual]", "0"}], "||", 
        RowBox[{"j", "\[NotEqual]", "0"}], "||", 
        RowBox[{"k", "\[NotEqual]", "0"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{"I", "*", 
            RowBox[{"ar", ".", "b2"}]}], "]"}]}], ")"}], "*", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"arn", "^", "2"}]}], "/", "c"}], "]"}], "/", 
         RowBox[{"arn", "^", "2"}]}]}], ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"s2", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "\[NotEqual]", "0"}], "||", 
        RowBox[{"j", "\[NotEqual]", "0"}], "||", 
        RowBox[{"k", "\[NotEqual]", "0"}]}], ",", 
       RowBox[{
        RowBox[{"Erfc", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sqrt", "[", "c", "]"}], "/", "2"}], "*", "an"}], "]"}], 
        "/", "an"}], ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"s3", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Erfc", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", "c", "]"}], "/", "2"}], "*", 
        RowBox[{"Norm", "[", 
         RowBox[{"b2", "+", "aa"}], "]"}]}], "]"}], "/", 
      RowBox[{"Norm", "[", 
       RowBox[{"b2", "+", "aa"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"-", "n"}], ",", "n"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"c", "/", "Pi"}], "]"}]}], "+", 
        RowBox[{"16", "*", "Pi", "*", "s1"}], "+", "s2", "-", "s3"}], ")"}]}],
      "/", "2"}], "/.", 
    RowBox[{"a", "\[Rule]", "1"}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Madelung", " ", "constant"}], "*)"}]}], "\n"}], "Input",
 CellChangeTimes->{{3.823812290189329*^9, 
  3.8238123154232693`*^9}},ExpressionUUID->"2eeccf07-727a-4bc5-8559-\
4085bafa14eb"]
},
WindowSize->{808, 911},
WindowMargins->{{Automatic, 312}, {228, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5429, 176, 538, "Input",ExpressionUUID->"2eeccf07-727a-4bc5-8559-4085bafa14eb"]
}
]
*)

